<mat-tab-group (selectedTabChange)="map = $event">
  <mat-tab label="List">
    <section fxLayout="row" fxLayoutAlign="center">
      <div fxFlex.xs="100" fxFlex.gt-sm="80" fxFlex.gt-lg="60" class="mat-card-padding">
        <mat-card>
          <mat-card-content>
            <mat-form-field>
              <input matInput placeholder="Search by name" (keyup)="search($event.target.value)" #searchBar>
            </mat-form-field>
          </mat-card-content>
        </mat-card>
      </div>
    </section>
    <mat-list class="container">
      <div fxLayout="column" fxLayout.gt-xs="row" fxLayoutWrap>
        <ng-template ngFor let-item [ngForOf]="items">
          <mat-list-item fxHide.gt-xs="true" [routerLink]="['/', 'profile', item.$key]">
            <img mat-list-icon [src]="item.photo || './assets/profile.png'" [alt]="item.name">
            <h4 mat-line>{{item.name}}</h4>
            <p mat-line>{{item.location}}</p>
          </mat-list-item>
          <mat-divider [fxHide.gt-xs]="true"></mat-divider>
          <div fxHide.lt-sm="true" fxFlex.gt-xs="50" fxFlex.gt-sm="33" fxFlex.gt-md="25" class="mat-card-padding">
            <mat-card>
              <mat-card-header>
                <img mat-card-avatar [src]="item.photo || './assets/profile.png'" [alt]="item.name">
                <mat-card-title>{{item.name}}</mat-card-title>
                <mat-card-subtitle>{{item.location}}</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <div *ngIf="item.about">
                  <h5>About</h5>
                  <p>{{item.about}}</p>
                </div>
                <div class="chips" *ngIf="item.topics && item.topics.length > 0">
                  <h5>Topics</h5>
                  <mat-chip-list>
                    <mat-chip *ngFor="let topic of item.topics" color="accent" selected="true">{{topic}}</mat-chip>
                  </mat-chip-list>
                </div>
              </mat-card-content>
              <mat-card-actions>
                <a mat-button [routerLink]="['/', 'profile',item.$key]">VIEW PROFILE</a>
              </mat-card-actions>
            </mat-card>
          </div>
        </ng-template>
      </div>
    </mat-list>
  </mat-tab>
  <mat-tab label="Map">
    <agm-map *ngIf="map" [latitude]="(coordsMap | async)?.lat" [longitude]="(coordsMap | async)?.lng" (centerChange)="centerChange($event)"
      (swipe)="swipe($event)" [zoom]="16" [zoomControl]="false" [streetViewControl]="false" [usePanning]="true" [fullscreenControl]="false"
      [gestureHandling]="'greedy'">
      <agm-marker [latitude]="(coordsUser | async)?.lat" [longitude]="(coordsUser | async)?.lng" iconUrl="./assets/map/bluedot.png"></agm-marker>
      <agm-marker-cluster imagePath="./assets/map/women" [averageCenter]="true" [styles]="[{url: './assets/map/women.png', textColor: '#fff', textSize: '16', height: '48', width: '48'}, {url: './assets/map/women.png', textColor: '#fff', textSize: '16', height: '48', width: '48'}, {url: './assets/map/women.png', textColor: '#fff', textSize: '16', height: '48', width: '48'}, {url: './assets/map/women.png', textColor: '#fff', textSize: '16', height: '48', width: '48'}, {url: './assets/map/women.png', textColor: '#fff', textSize: '16', height: '48', width: '48'}]">
        <agm-marker *ngFor="let marker of markers | async; trackBy: trackByFn" (markerClick)="clickedMarker(marker.$key)" [latitude]="marker.coordinates.lat"
          [longitude]="marker.coordinates.lng" iconUrl="./assets/map/woman.png">
          <agm-info-window *ngIf="isOpen(marker.$key)" [isOpen]="isOpen(marker.$key)">
            <mat-card>
              <mat-card-header>
                <img mat-card-avatar [src]="(person | async)?.photo || './assets/profile.png'" [alt]="(person | async)?.name">
                <mat-card-title>{{(person | async)?.name}}</mat-card-title>
                <mat-card-subtitle>{{(person | async)?.location}}</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <div [class.hidden]="!(person | async)?.about">
                  <h5>About</h5>
                  <p>{{(person | async)?.about}}</p>
                </div>
                <div class="chips" [class.hidden]="!(person | async)?.topics && !(person | async)?.topics?.length > 0">
                  <h5>Topics</h5>
                  <mat-chip-list>
                    <mat-chip *ngFor="let topic of (person | async)?.topics" color="accent" selected="true">{{topic}}</mat-chip>
                  </mat-chip-list>
                </div>
              </mat-card-content>
              <mat-card-actions>
                <a [routerLink]="['/', 'profile', marker.$key]" mat-button>VIEW PROFILE</a>
              </mat-card-actions>
            </mat-card>
          </agm-info-window>
        </agm-marker>
      </agm-marker-cluster>
    </agm-map>
    <button mat-fab (click)="toggleWatch()">
      <mat-icon>{{(updating | async)? 'gps_fixed' : 'gps_off'}}</mat-icon>
    </button>
  </mat-tab>
</mat-tab-group>